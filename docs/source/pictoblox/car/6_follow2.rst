.. _sh_follow2:

3.6 あなたの手を追跡する2
==============================

:ref:`sh_follow1` のプロジェクトでは、超音波モジュールのみが使用されており、前方の手だけを追跡することができます。

このプロジェクトでは、2つのIR障害物回避モジュールを同時に使用することで、車があなたの手を左または右に追跡できるようになります。

必要な部品
---------------------

このプロジェクトに必要な部品は以下のとおりです。

一式のキットを購入することは非常に便利です。以下がリンクです： 

.. list-table::
    :widths: 20 20 20
    :header-rows: 1

    *   - 名前
        - このキットのアイテム
        - リンク
    *   - 3 in 1 Starter Kit
        - 380+
        - |link_3IN1_kit|

以下のリンクから個別に購入することもできます。

.. list-table::
    :widths: 30 20
    :header-rows: 1

    *   - コンポーネントの紹介
        - 購入リンク

    *   - :ref:`cpn_uno`
        - |link_Uno_R3_buy|
    *   - :ref:`cpn_l298n` 
        - |link_l298n_buy|
    *   - :ref:`cpn_tt_motor`
        - \-
    *   - :ref:`cpn_ultrasonic`
        - |link_ultrasonic_buy|
    *   - :ref:`cpn_avoid` 
        - |link_obstacle_avoidance_buy|

回路の作成
-----------------------

超音波モジュールと2つのIR障害物回避モジュールを同時に接続します。

超音波モジュールとR3ボード間の配線は以下の通りです。

.. list-table:: 

    * - 超音波モジュール
      - R3ボード
    * - Vcc
      - 5V
    * - Trig
      - 3
    * - Echo
      - 4
    * - Gnd
      - GND

2つのIR障害物回避モジュールとR3ボード間の配線は以下の通りです。

.. list-table:: 

    * - 左IRモジュール
      - R3ボード
    * - OUT
      - 8
    * - GND
      - GND
    * - VCC
      - 5V

.. list-table:: 

    * - 右IRモジュール
      - R3ボード
    * - OUT
      - 7
    * - GND
      - GND
    * - VCC
      - 5V

.. image:: img/car_avoid_ultrasonic.jpg
    :width: 800

プログラミング
---------------

このプロジェクトで達成したい効果は以下の通りです

* 超音波は、前方で5-10cmの距離で手を検出し、車を追跡させます。
* 左の赤外線モジュールが手を検出すると、左に曲がります。
* 右のIRモジュールが手を検出すると、右に曲がります。

**1. ブロックを作成する**

前進、左折、右折、停止するためのブロックを作成します。

.. image:: img/6_follow2_1.png

**2. 前進するための追跡**

超音波の値を読み取り、手が5-10cmの距離で検出された場合、車を追跡させます。

.. image:: img/6_follow2_2.png

**3. 左と右に追跡する**

左と右のIRモジュールの値を読み取ります。

* 左のIRモジュールが手を検出した場合、左に曲がります。
* 右のIRモジュールが手を検出した場合、右に曲がります。
* 両方のIRモジュールと超音波モジュールが手を検出しない場合、車を停止させます。

.. image:: img/6_follow2_3.png
